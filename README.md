# AI FUN бот - ChatGPT, StableDiffusion, Pexels

## Основная информация

Да, да, да, очередная обертка для модных AI апишечек. Тут сразу 3 в одном, хотя даже скорее 2,5 в одном, тк pexels.com это просто база картинок. В комплекте сразу возможность запустить бота через вебхук на виртуальном сервере, но можно и на простом поллинге для себя (друзей). Подключается платежка для ChatGPT, ведется база пользователей, биллинг токенов туда-же.
Стартует все это дело в докере с nginx.

Настройка виртуального сервера и старт бота с вебхуком описан в отдельном репозитории: https://github.com/ssharkexe/telegram-nginx-docker-webhook, тут углубляться не буду. 

Точно потребуются:
1. API ключ вашего бота Telegram
2. API ключ ChatGPT (подписка не обязательна, можно просто закинуть пару баксов на счет)
3. API ключ pexels.com
4. Telegram ID администратора бота
5. Токен платежного шлюза Telegram (можно тестовый)

По желанию:
1. Домен, привязанный к вашему виртуальному серверу
2. Proxy с аутентификацией: [хост, порт, логин, пароль] (это если ваш виртуальный сервер в ru-сегменте, chatgpt и pexels капризничают)
<br/><br/>
## Подготовка

Деплой бота максимально простой. По умолчанию работает на поллинге. В папке /bot лежит .env файл, в котором уже прописано IS_WEBHOOK = False. В кавычках заполняем другие переменные окружения. Для отладки локально можно эти переменные забить в среду через команду export ПЕРЕМЕННАЯ=ЗНАЧЕНИЕ (без кавычек). 
<br/><br/>
**Подготовка**

1. Подготавливаем сервер:

    1.1. Заходим на сервер по ssh, устаналиваем docker (compose также установится в комплекте) по гайду: https://docs.docker.com/engine/install/ubuntu/. Самый простой вариант - добавить репозиторий и скачать последнюю версию. Если ошибок нет - отлично, двигаемся дальше.

    1.2. Клонируем этот репозиторий полностью:
    ```
    git clone https://github.com/ssharkexe/AI-fun-bot.git
    ```

    1.3. Переходим в папку с проектом, далее в папку bot и прописываем переменные окружения в .env файл:
    ```
    cd AI-fun-bot/bot
    sudo nano .env
    ```
    указываем в кавычках API ключи и другую инфу, сохраняем.


2. Все готово, можем запускать бота:
    
    2.1 В командной строке пишем:
    ```
    docker compose --env-file .env build
    docker compose run -d bot
    ```
    2.2 Если все сделали верно, то вам в Telegram (как админу бота) придет сообщение об успешном старте

    2.3 При попытке других пользователей пообщаться с ботом админу придет уведомление, можно разрешить/запретить использование бота для каждого конкретного пользователя
<br/><br/>
## Финальная часть. Что вообще делать то с ботом?

- Общаться с chatGPT (возможно переключаться между 3 и 4 версиями GPT), сбрасывать контекст, выбирать роли собеседника (попробуйте гопника!)
- Генерировать картинки через Stable Diffusion по промту (параллельно выбирая разные стили) - каждый пользователь может сгенерировать свой токен и добавить его в бота
- Модифицировать ваши изображения по промту, подстраивать стили
- Выполнять поиск картинок на pexels.com по текстовому промту
- Админить пользователей бота, удалять их из базы
<br/><br/>
## Заметки
Если вылезут баги, прошу оформить Issue.